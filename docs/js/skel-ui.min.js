/* skel-ui.js v0.2 | (c) n33 | n33.co @n33co | MIT + GPLv2 */skel.registerPlugin("ui",function(){var a={config:{baseZIndex:1E4,speed:250,panels:{},bars:{}},cache:{panels:{},bars:{},body:null,window:null,pageWrapper:null,defaultWrapper:null,fixedWrapper:null,activePanel:null},deviceType:null,eventType:"click",isTouch:!1,presets:{standard:{panels:{navPanel:{breakpoints:"mobile",position:"left",style:"push",size:"80%",html:'<div data-action="navList" data-target="nav"></div>'}},bars:{titleBar:{breakpoints:"mobile",position:"top",size:44,style:"floating",html:'<span class="toggle" data-action="panelToggle" data-target="navPanel"></span><span class="title" data-action="copyHTML" data-target="logo"></span>'}}}},defaults:{config:{panel:{breakpoints:null,position:null,style:null,size:"80%",html:"",resetScroll:!0,resetForms:!0,swipeToClose:!0},bar:{breakpoints:null,position:null,style:null,size:44,style:"floating",html:""}}},parseSuspend:function(a){a=a.get(0);a.suspend_skel&&a.suspend_skel()},parseResume:function(a){a=a.get(0);a.resume_skel&&a.resume_skel()},parseInit:function(c){var b,d;b=c.get(0);var f=c.attr("data-action"),e=c.attr("data-target")?jQuery("#"+c.attr("data-target")):null,g=1==c.attr("data-target-hide");switch(f){case "panelToggle":c.css("-webkit-tap-highlight-color","rgba(0,0,0,0)").css("cursor","pointer");b=function(b){b.preventDefault();b.stopPropagation();b=jQuery(this);b=a.cache.panels[b.attr("data-target")];b.is(":visible")?b.close_skel():b.open_skel()};"android"==a.deviceType?c.bind("click",b):c.bind(a.eventType,b);break;case "navList":b=e.find("a");d=[];b.each(function(){var a=jQuery(this),b;b=Math.max(0,a.parents("li").length-1);d.push('<a class="link depth-'+b+'" href="'+a.attr("href")+'"><span class="indent-'+b+'"></span>'+a.text()+"</a>")});0<d.length&&c.html("<nav>"+d.join("")+"</nav>");c.find(".link").css("cursor","pointer").css("display","block");break;case "copyText":c.html(e.text());break;case "copyHTML":c.html(e.html());break;case "moveHTML":b.resume_skel=function(){e.children().each(function(){c.append(jQuery(this))});g&&e.hide()};b.suspend_skel=function(){c.children().each(function(){e.append(jQuery(this))});g&&e.show()};b.resume_skel();break;case "moveElement":b.resume_skel=function(){jQuery('<div id="skel-ui-tmp-'+e.attr("id")+'" />').insertBefore(e);c.append(e)},b.suspend_skel=function(){jQuery("#skel-ui-tmp-"+e.attr("id")).replaceWith(e)},b.resume_skel()}},lockView:function(c){a.cache.window.scrollPos_skel=a.cache.window.scrollTop();a.cache.body.css("overflow-"+c,"hidden");a.cache.pageWrapper.bind("touchstart.lock",function(b){b.preventDefault();b.stopPropagation();a.cache.activePanel&&a.cache.activePanel.close_skel()});a.cache.pageWrapper.bind("click.lock",function(b){b.preventDefault();b.stopPropagation();a.cache.activePanel&&a.cache.activePanel.close_skel()});a.cache.pageWrapper.bind("scroll.lock",function(b){b.preventDefault();b.stopPropagation();a.cache.activePanel&&a.cache.activePanel.close_skel()});a.cache.window.bind("orientationchange.lock",function(b){a.cache.activePanel&&a.cache.activePanel.close_skel()});a.isTouch||(a.cache.window.bind("resize.lock",function(b){a.cache.activePanel&&a.cache.activePanel.close_skel()}),a.cache.window.bind("scroll.lock",function(b){a.cache.activePanel&&a.cache.activePanel.close_skel()}))},unlockView:function(c){a.cache.body.css("overflow-"+c,"visible");a.cache.pageWrapper.unbind("touchstart.lock");a.cache.pageWrapper.unbind("click.lock");a.cache.pageWrapper.unbind("scroll.lock");a.cache.window.unbind("orientationchange.lock");a.isTouch||(a.cache.window.unbind("resize.lock"),a.cache.window.unbind("scroll.lock"))},resumeComponent:function(c){a.cache[c.type+"s"][c.id].find("*").each(function(){a.parseResume(jQuery(this))})},suspendComponent:function(c){c=a.cache[c.type+"s"][c.id];c.css("transform","translate(0,0)");c.find("*").each(function(){a.parseSuspend(jQuery(this))})},initComponent:function(c){var b=c.config,d=jQuery(c.object);a.cache[c.type+"s"][c.id]=d;d.applyTransition_skel().accelerate_skel();d.find("*").each(function(){a.parseInit(jQuery(this))});switch(c.type){case "panel":d.addClass("skel-ui-panel").css("z-index",a.config.baseZIndex).css("position","fixed").hide();d.find("a").css("-webkit-tap-highlight-color","rgba(0,0,0,0)").click(function(b){b.preventDefault();b.stopPropagation();var c=jQuery(this).attr("href");a.cache.activePanel.close_skel();window.setTimeout(function(){window.location.href=c},a.config.speed+10)});"ios"==a.deviceType&&d.find("input,select,textarea").focus(function(b){var c=jQuery(this);b.preventDefault();b.stopPropagation();window.setTimeout(function(){var b=a.cache.window.scrollPos_skel,d=a.cache.window.scrollTop()-b;a.cache.window.scrollTop(b);a.cache.activePanel.scrollTop(a.cache.activePanel.scrollTop()+d);c.hide();window.setTimeout(function(){c.show()},0)},100)});switch(b.position){case "left":case "right":var f="right"==b.position?"-":"";d.addClass("skel-ui-panel-"+b.position).css("width",b.size).scrollTop(0);a.isTouch?d.css("overflow-y","scroll").css("-webkit-overflow-scrolling","touch").bind("touchstart",function(a){d._posY=a.originalEvent.touches[0].pageY;d._posX=a.originalEvent.touches[0].pageX}).bind("touchmove",function(a){var c=d._posX-a.originalEvent.touches[0].pageX;a=d._posY-a.originalEvent.touches[0].pageY;var f=d.outerHeight(),h=d.get(0).scrollHeight-d.scrollTop();if(b.swipeToClose&&20>a&&-20<a&&("left"==b.position&&50<c||"right"==b.position&&-50>c))return d.close_skel(),!1;if(0==d.scrollTop()&&0>a||h>f-2&&h<f+2&&0<a)return!1}):d.css("overflow-y","auto");switch(b.style){case "push":d.open_skel=function(){d.promote_skel().scrollTop(0).css("top",0).css(b.position,"-"+b.size).css("height","100%").show();b.resetScroll&&d.scrollTop(0);b.resetForms&&d.resetForms_skel();a.lockView("x");window.setTimeout(function(){d.css("transform","translate("+f+"100%,0)");a.cache.pageWrapper.css("transform","translate("+f+b.size+",0)");a.cache.fixedWrapper.children().css("transform","translate("+f+b.size+",0)");a.cache.activePanel=d},100)};d.close_skel=function(){d.find("*").blur();d.css("transform","translate(0,0)");a.cache.pageWrapper.css("transform","translate(0,0)");a.cache.fixedWrapper.children().css("transform","translate(0,0)");window.setTimeout(function(){a.unlockView("x");d.demote_skel().hide();a.cache.activePanel=null},a.config.speed+50)};break;case "reveal":d.open_skel=function(){a.cache.fixedWrapper.promote_skel(2);a.cache.pageWrapper.promote_skel(1);d.scrollTop(0).css("top",0).css(b.position,0).css("height","100%").show();b.resetScroll&&d.scrollTop(0);b.resetForms&&d.resetForms_skel();a.lockView("x");window.setTimeout(function(){a.cache.pageWrapper.css("transform","translate("+f+b.size+",0)");a.cache.fixedWrapper.children().css("transform","translate("+f+b.size+",0)");a.cache.activePanel=d},100)},d.close_skel=function(){d.find("*").blur();d.css("transform","translate(0,0)");a.cache.pageWrapper.css("transform","translate(0,0)");a.cache.fixedWrapper.children().css("transform","translate(0,0)");window.setTimeout(function(){a.unlockView("x");d.hide();a.cache.pageWrapper.demote_skel();a.cache.pageWrapper.demote_skel();a.cache.activePanel=null},a.config.speed+50)}}}break;case "bar":d.css("z-index",a.config.baseZIndex).addClass("skel-ui-bar");switch(b.style){case "floating":d.css("position","fixed");break;case "fixed":d.css("position","absolute")}switch(b.position){case "top":d.addClass("skel-ui-bar-top").css("top",0).css("left",0).css("width","100%").css("height",b.size);break;case "bottom":d.addClass("skel-ui-bar-bottom").css("bottom",0).css("left",0).css("width","100%").css("height",b.size);break;case "left":d.addClass("skel-ui-bar-left").css("top",0).css("left",0).css("width",b.size).css("height","100%");break;case "right":d.addClass("skel-ui-bar-right").css("top",0).css("right",0).css("width",b.size).css("height","100%")}}},initComponents:function(c){var b,d,f,e,g;for(d in a.config[c+"s"])for(g in b={},a._.extend(b,a.defaults.config[c]),a._.extend(b,a.config[c+"s"][d]),a.config[c+"s"][d]=b,f=a._.newDiv(b.html),f.id=d,f.className="skel-ui-"+c,e=b.breakpoints.split(","),e)z=a._.cacheBreakpointElement(e[g],d,f,"bar"==c?"skel_ui_fixedWrapper":"skel_ui_defaultWrapper",2),z.config=b,z.initialized=!1,z.type=c,z.onAttach=function(){this.initialized?a.resumeComponent(this):(a.initComponent(this),this.initialized=!0)},z.onDetach=function(){a.suspendComponent(this)}},initHelpers:function(){jQuery.fn.promote_skel=function(c){this._zIndex=this.css("z-index");this.css("z-index",a.config.baseZIndex+(c?c:1));return this};jQuery.fn.demote_skel=function(){this._zIndex&&(this.css("z-index",this._zIndex),this._zIndex=null);return this};jQuery.fn.accelerate_skel=function(){return jQuery(this).css("backface-visibility","hidden").css("perspective","500")};jQuery.fn.xcssValue_skel=function(a,b){return jQuery(this).css(a,"-moz-"+b).css(a,"-webkit-"+b).css(a,"-o-"+b).css(a,"-ms-"+b).css(a,b)};jQuery.fn.xcssProperty_skel=function(a,b){return jQuery(this).css("-moz-"+a,b).css("-webkit-"+a,b).css("-o-"+a,b).css("-ms-"+a,b).css(a,b)};jQuery.fn.xcss_skel=function(a,b){return jQuery(this).css("-moz-"+a,"-moz-"+b).css("-webkit-"+a,"-webkit-"+b).css("-o-"+a,"-o-"+b).css("-ms-"+a,"-ms-"+b).css(a,b)};jQuery.fn.applyTransition_skel=function(){return jQuery(this).xcss_skel("transition","transform "+a.config.speed/1E3+"s ease-in-out")};jQuery.fn.clearTransition_skel=function(){return jQuery(this).xcss_skel("transition","none")};jQuery.fn.resetForms_skel=function(){var a=jQuery(this);jQuery(this).find("form").each(function(){this.reset()});return a}},initObjects:function(){a.cache.window=jQuery(window);a.cache.window.load(function(){0==a.cache.window.scrollTop()&&window.scrollTo(0,1)});a._.DOMReady(function(){a.cache.body=jQuery("body");a.cache.body.wrapInner('<div id="skel-ui-pageWrapper" />');a.cache.pageWrapper=jQuery("#skel-ui-pageWrapper");a.cache.pageWrapper.css("position","relative").css("left","0").css("right","0").css("top","0").css("bottom","0").applyTransition_skel().accelerate_skel();a.cache.defaultWrapper=jQuery('<div id="skel-ui-defaultWrapper" />').appendTo(a.cache.body);a.cache.defaultWrapper.css("height","100%");a.cache.fixedWrapper=jQuery('<div id="skel-ui-fixedWrapper" />').appendTo(a.cache.body);a.cache.fixedWrapper.css("position","relative");jQuery(".skel-ui-fixed").appendTo(a.cache.fixedWrapper);a._.registerLocation("skel_ui_defaultWrapper",a.cache.defaultWrapper[0]);a._.registerLocation("skel_ui_fixedWrapper",a.cache.fixedWrapper[0]);a._.registerLocation("skel_ui_pageWrapper",a.cache.pageWrapper[0])})},initDeviceType:function(){var c,b={ios:"(iPad|iPhone|iPod)",android:"Android"};for(c in b)if(navigator.userAgent.match(RegExp(b[c],"g"))){a.deviceType=c;break}a.deviceType||(a.deviceType="other");a.isTouch=!!("ontouchstart"in window);a.eventType=a.isTouch?"touchend":"click"},init:function(){a.initDeviceType();a.initHelpers();a.initObjects();a.initComponents("bar");a.initComponents("panel");a._.updateState()}};return a}());